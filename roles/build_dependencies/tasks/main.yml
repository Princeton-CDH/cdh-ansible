---
# # need to update ca-certificates to avoid problem with phusion passenger file
# # https://github.com/phusion/passenger/issues/2303#issuecomment-931571362
# - name: update ca certificates
#   become: true
#   tags: setup
#   apt:
#     name: "ca-certificates"
#     state: latest

- name: install configured dependencies
  become: true
  tags:
    - setup
    - never
  apt:
    name: "{{ common_dependencies + app_dependencies }}"
    state: present
    # update cache fails on bionic because postgres no longer has a release
    # only update cache on newer VMs; skip updating on older vms
    update_cache: "{{ ansible_distribution_version != '18.04' }}"
  changed_when: false
  when: ansible_distribution == 'Ubuntu'

- name: configure tmux
  become: true
  tags:
    - setup
    - never
  copy:
    src: "tmux.conf"
    dest: "/etc/tmux.conf"
    mode: u=rw,g=r,o=r
