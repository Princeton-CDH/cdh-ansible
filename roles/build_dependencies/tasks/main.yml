---
# # need to update ca-certificates to avoid problem with phusion passenger file
# # https://github.com/phusion/passenger/issues/2303#issuecomment-931571362
# - name: update ca certificates
#   become: true
#   tags: setup
#   apt:
#     name: "ca-certificates"
#     state: latest

- name: Load vaulted setup variables if running setup tasks
  tags: setup
  ansible.builtin.include_vars:
    file: ../group_vars/setup/vault.yml
  when: geniza_deploy_only is undefined

- name: install configured dependencies
  become: true
  tags: setup
  apt:
    name: "{{ common_dependencies + app_dependencies }}"
    state: present
    update_cache: true
  changed_when: false
  when: ansible_distribution == 'Ubuntu'

- name: configure tmux
  become: true
  tags: setup
  copy:
    src: "tmux.conf"
    dest: "/etc/tmux.conf"
    mode: u=rw,g=r,o=r
